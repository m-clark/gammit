<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Extract random effects from a gam — extract_ranef • gammit</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Extract random effects from a gam — extract_ranef" />
<meta property="og:description" content="Extract what would be the random effects from a mixed model from
a gam object.  Assumes an mgcv model of the form gam(... + s(g, bs='re'))." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gammit</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/m-clark">
    <span class="fa fa-github-alt"></span>
     
  </a>
</li>
<li>
  <a href="https://m-clark.github.io">
    <span class="fa fa-empire"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extract random effects from a gam</h1>
    <small class="dont-index">Source: <a href='https://github.com/m-clark/gammit/blob/master/R/extract_ranef.R'><code>R/extract_ranef.R</code></a></small>
    <div class="hidden name"><code>extract_ranef.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Extract what would be the random effects from a mixed model from
a gam object.  Assumes an mgcv model of the form <code><a href='https://rdrr.io/pkg/mgcv/man/gam.html'>gam(... + s(g, bs='re'))</a></code>.</p>
    </div>

    <pre class="usage"><span class='fu'>extract_ranef</span>(<span class='kw'>model</span>, re = <span class='kw'>NULL</span>, ci_level = <span class='fl'>0.95</span>, digits = <span class='fl'>3</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>model</th>
      <td><p>A gam or bam model</p></td>
    </tr>
    <tr>
      <th>re</th>
      <td><p>Filter results to a specific random effect/grouping variable.</p></td>
    </tr>
    <tr>
      <th>ci_level</th>
      <td><p>Level for the confidence interval. Must be between 0 and 1.</p></td>
    </tr>
    <tr>
      <th>digits</th>
      <td><p>Rounding for the output.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>tibble</code> or data frame with the random effect,
its standard error, and its lower and upper bounds. The bounds are based
on a simple normal approximation using the standard error.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Returns a data frame of the the <code>component</code> type, the estimated
random effect <code>re</code>, the estimated <code>se</code>, and approximate <code>lower</code> and <code>upper</code>
bounds.  Note that the standard errors are Bayesian
estimates (see <code><a href='https://rdrr.io/pkg/mgcv/man/gamObject.html'>gamObject</a></code>, specifically type <code>Vp</code>).  The <code>re</code>
will only reflect smooth terms whose basis function is 're', i.e. of class
<code>random.effect</code>.  Others will be ignored.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p><code>mgcv</code> strips the level names for 're' smooth terms, so this attempts
to get them back. This may not work under every circumstance, but the
attempt is made to extract the names of random effect groups based on how
they are ordered in the data (which is how the model matrix would be
constructed), and in the case of random slopes, detect that second variable
in the 're' specification would be the grouping variable. This will not
work for continuous x continuous smooths of type 're', but I can't think of
a reason why you'd use that given your other options with <code>mgcv</code>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/lme4/man/ranef.html'>ranef</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='kw'>mgcv</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='kw'><a href='https://github.com/lme4/lme4'>lme4</a></span>)

<span class='kw'>lmer_model</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span>(<span class='kw'>Reaction</span> <span class='op'>~</span> <span class='kw'>Days</span> <span class='op'>+</span> (<span class='kw'>Days</span> <span class='op'>||</span> <span class='kw'>Subject</span>), data = <span class='kw'>sleepstudy</span>)
<span class='kw'>ga_model</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/mgcv/man/gam.html'>gam</a></span>(<span class='kw'>Reaction</span> <span class='op'>~</span> <span class='kw'>Days</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/pkg/mgcv/man/s.html'>s</a></span>(<span class='kw'>Subject</span>, bs = <span class='st'>"re"</span>) <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/pkg/mgcv/man/s.html'>s</a></span>(<span class='kw'>Days</span>, <span class='kw'>Subject</span>, bs = <span class='st'>"re"</span>),
  data = <span class='kw'>sleepstudy</span>,
  method = <span class='st'>"REML"</span>
)

<span class='fu'><a href='https://rdrr.io/pkg/lme4/man/ranef.html'>ranef</a></span>(<span class='kw'>lmer_model</span>)
</div><div class='output co'>#&gt; $Subject
#&gt;     (Intercept)        Days
#&gt; 308   1.5126648   9.3234970
#&gt; 309 -40.3738728  -8.5991757
#&gt; 310 -39.1810279  -5.3877944
#&gt; 330  24.5189244  -4.9686503
#&gt; 331  22.9144470  -3.1939378
#&gt; 332   9.2219759  -0.3084939
#&gt; 333  17.1561243  -0.2872078
#&gt; 334  -7.4517382   1.1159911
#&gt; 335   0.5787623 -10.9059754
#&gt; 337  34.7679030   8.6276228
#&gt; 349 -25.7543312   1.2806892
#&gt; 350 -13.8650598   6.7564064
#&gt; 351   4.9159912  -3.0751356
#&gt; 352  20.9290332   3.5122123
#&gt; 369   3.2586448   0.8730514
#&gt; 370 -26.4758468   4.9837910
#&gt; 371   0.9056510  -1.0052938
#&gt; 372  12.4217547   1.2584037
#&gt; 
#&gt; with conditional variances for “Subject” </div><div class='input'><span class='fu'>extract_ranef</span>(<span class='kw'>ga_model</span>)
</div><div class='output co'>#&gt; <span style='color: #555555;'># A tibble: 36 x 7</span><span>
#&gt;    group_var effect    group   value    se lower_2.5 upper_97.5
#&gt;    </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>     </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>     </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>   </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>     </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>      </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #555555;'> 1</span><span> Subject   Intercept 308     1.51   13.3    -</span><span style='color: #BB0000;'>24.5</span><span>        27.5
#&gt; </span><span style='color: #555555;'> 2</span><span> Subject   Intercept 309   -</span><span style='color: #BB0000;'>40.4</span><span>    13.3    -</span><span style='color: #BB0000;'>66.4</span><span>       -</span><span style='color: #BB0000;'>14.3</span><span>
#&gt; </span><span style='color: #555555;'> 3</span><span> Subject   Intercept 310   -</span><span style='color: #BB0000;'>39.2</span><span>    13.3    -</span><span style='color: #BB0000;'>65.2</span><span>       -</span><span style='color: #BB0000;'>13.2</span><span>
#&gt; </span><span style='color: #555555;'> 4</span><span> Subject   Intercept 330    24.5    13.3     -</span><span style='color: #BB0000;'>1.51</span><span>       50.5
#&gt; </span><span style='color: #555555;'> 5</span><span> Subject   Intercept 331    22.9    13.3     -</span><span style='color: #BB0000;'>3.11</span><span>       48.9
#&gt; </span><span style='color: #555555;'> 6</span><span> Subject   Intercept 332     9.22   13.3    -</span><span style='color: #BB0000;'>16.8</span><span>        35.2
#&gt; </span><span style='color: #555555;'> 7</span><span> Subject   Intercept 333    17.2    13.3     -</span><span style='color: #BB0000;'>8.87</span><span>       43.2
#&gt; </span><span style='color: #555555;'> 8</span><span> Subject   Intercept 334    -</span><span style='color: #BB0000;'>7.45</span><span>   13.3    -</span><span style='color: #BB0000;'>33.5</span><span>        18.6
#&gt; </span><span style='color: #555555;'> 9</span><span> Subject   Intercept 335     0.579  13.3    -</span><span style='color: #BB0000;'>25.4</span><span>        26.6
#&gt; </span><span style='color: #555555;'>10</span><span> Subject   Intercept 337    34.8    13.3      8.74       60.8
#&gt; </span><span style='color: #555555;'># … with 26 more rows</span><span></div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://m-clark.github.io'><img src="man/figures/mc_logo.png" width=10% style='display:inline'/></a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


