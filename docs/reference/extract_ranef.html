<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Extract random effects from a gam — extract_ranef • gammit</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Extract random effects from a gam — extract_ranef" />
<meta property="og:description" content="Extract what would be the random effects from a mixed model from
a gam object.  Assumes an mgcv model of the form gam(... + s(g, bs='re'))." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gammit</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/m-clark">
    <span class="fa fa-github-alt"></span>
     
  </a>
</li>
<li>
  <a href="https://m-clark.github.io">
    <span class="fa fa-empire"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extract random effects from a gam</h1>
    <small class="dont-index">Source: <a href='https://github.com/m-clark/gammit/blob/master/R/extract_ranef.R'><code>R/extract_ranef.R</code></a></small>
    <div class="hidden name"><code>extract_ranef.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Extract what would be the random effects from a mixed model from
a gam object.  Assumes an mgcv model of the form <code>gam(... + s(g, bs='re'))</code>.</p>
    </div>

    <pre class="usage"><span class='fu'>extract_ranef</span>(<span class='no'>model</span>, <span class='kw'>re</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>tibble</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>model</th>
      <td><p>The mgcv model</p></td>
    </tr>
    <tr>
      <th>re</th>
      <td><p>Which specific coefficients to extract. Currently not
implemented.</p></td>
    </tr>
    <tr>
      <th>tibble</th>
      <td><p>Return a tibble or standard default data.frame.  Default is
<code>TRUE</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>tibble</code> (if <code>tibble = TRUE</code>) or data frame with the random effect,
its standard error, and its lower and upper bounds. The bounds are based
on a simple normal approximation using the standard error.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Returns a data frame of the the <code>component</code> type, the estimated
random effect <code>re</code>, the estimated <code>se</code>, and approximate <code>lower</code> and <code>upper</code>
bounds assuming  <code>+- 1.96*se</code>.  Note that the standard errors are Bayesian
estimates (see <code><a href='https://rdrr.io/pkg/mgcv/man/gamObject.html'>gamObject</a></code>, specifically type <code>Vp</code>).  The <code>re</code>
will only reflect smooth terms whose basis function is 're', i.e. of class
<code>random.effect</code>.  Others will be ignored.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p><code>mgcv</code> strips the level names for 're' smooth terms, so this attempts
to get them back. This may not work under every circumstance, but the
attempt is made to extract the names of random effect groups based on how
they are ordered in the data (which is how the model matrix would be
constructed), and in the case of random slopes, detect that second variable
in the 're' specification would be the grouping variable. This will not
work for continuous x continuous smooths of type 're', but I can't think of
a reason why you'd use that given your other options with <code>mgcv</code>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/lme4/man/ranef.html'>ranef</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>mgcv</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>lme4</span>)

<span class='no'>lmer_model</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span>(<span class='no'>Reaction</span> ~ <span class='no'>Days</span> + (<span class='no'>Days</span> <span class='kw'>||</span> <span class='no'>Subject</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>sleepstudy</span>)
<span class='no'>ga_model</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/mgcv/man/gam.html'>gam</a></span>(<span class='no'>Reaction</span> ~ <span class='no'>Days</span> + <span class='fu'><a href='https://rdrr.io/pkg/mgcv/man/s.html'>s</a></span>(<span class='no'>Subject</span>, <span class='kw'>bs</span> <span class='kw'>=</span> <span class='st'>"re"</span>) + <span class='fu'><a href='https://rdrr.io/pkg/mgcv/man/s.html'>s</a></span>(<span class='no'>Days</span>, <span class='no'>Subject</span>, <span class='kw'>bs</span> <span class='kw'>=</span> <span class='st'>"re"</span>),
  <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>sleepstudy</span>,
  <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"REML"</span>
)

<span class='fu'><a href='https://rdrr.io/pkg/lme4/man/ranef.html'>ranef</a></span>(<span class='no'>lmer_model</span>)</div><div class='output co'>#&gt; $Subject
#&gt;     (Intercept)        Days
#&gt; 308   1.5116973   9.3237308
#&gt; 309 -40.3720066  -8.5995358
#&gt; 310 -39.1795117  -5.3880715
#&gt; 330  24.5188072  -4.9686809
#&gt; 331  22.9141930  -3.1939310
#&gt; 332   9.2217762  -0.3084673
#&gt; 333  17.1557243  -0.2871512
#&gt; 334  -7.4516633   1.1159907
#&gt; 335   0.5798353 -10.9062401
#&gt; 337  34.7661741   8.6279628
#&gt; 349 -25.7538155   1.2806250
#&gt; 350 -13.8653871   6.7565202
#&gt; 351   4.9161750  -3.0751926
#&gt; 352  20.9281601   3.5123758
#&gt; 369   3.2584763   0.8730848
#&gt; 370 -26.4756822   4.9838147
#&gt; 371   0.9057286  -1.0053150
#&gt; 372  12.4213189   1.2584805
#&gt; 
#&gt; with conditional variances for “Subject” </div><div class='input'><span class='fu'>extract_ranef</span>(<span class='no'>ga_model</span>)</div><div class='output co'>#&gt; <span style='color: #555555;'># A tibble: 36 x 6</span><span>
#&gt;    component group      re    se  lower upper
#&gt;    </span><span style='color: #555555;font-style: italic;'>&lt;fct&gt;</span><span>     </span><span style='color: #555555;font-style: italic;'>&lt;fct&gt;</span><span>   </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>  </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #555555;'> 1</span><span> Subject   308     1.51   13.3 -</span><span style='color: #BB0000;'>24.5</span><span>   27.5
#&gt; </span><span style='color: #555555;'> 2</span><span> Subject   309   -</span><span style='color: #BB0000;'>40.4</span><span>    13.3 -</span><span style='color: #BB0000;'>66.4</span><span>  -</span><span style='color: #BB0000;'>14.3</span><span>
#&gt; </span><span style='color: #555555;'> 3</span><span> Subject   310   -</span><span style='color: #BB0000;'>39.2</span><span>    13.3 -</span><span style='color: #BB0000;'>65.2</span><span>  -</span><span style='color: #BB0000;'>13.2</span><span>
#&gt; </span><span style='color: #555555;'> 4</span><span> Subject   330    24.5    13.3  -</span><span style='color: #BB0000;'>1.51</span><span>  50.5
#&gt; </span><span style='color: #555555;'> 5</span><span> Subject   331    22.9    13.3  -</span><span style='color: #BB0000;'>3.11</span><span>  48.9
#&gt; </span><span style='color: #555555;'> 6</span><span> Subject   332     9.22   13.3 -</span><span style='color: #BB0000;'>16.8</span><span>   35.2
#&gt; </span><span style='color: #555555;'> 7</span><span> Subject   333    17.2    13.3  -</span><span style='color: #BB0000;'>8.87</span><span>  43.2
#&gt; </span><span style='color: #555555;'> 8</span><span> Subject   334    -</span><span style='color: #BB0000;'>7.45</span><span>   13.3 -</span><span style='color: #BB0000;'>33.5</span><span>   18.6
#&gt; </span><span style='color: #555555;'> 9</span><span> Subject   335     0.579  13.3 -</span><span style='color: #BB0000;'>25.4</span><span>   26.6
#&gt; </span><span style='color: #555555;'>10</span><span> Subject   337    34.8    13.3   8.74  60.8
#&gt; </span><span style='color: #555555;'># … with 26 more rows</span><span></div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#note">Note</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://m-clark.github.io'><img src="man/figures/mc_logo.png" width=10% style='display:inline'/></a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


